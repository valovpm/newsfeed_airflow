# Apache Airflow и ETL-пайплайны для анализа Новостной Ленты



## airflow_clickhouse.py
Данный скрипт содержит Airflow-DAG для создания отчета,
который для каждого пользователя приложения считает:
* количество просмотров и лайков контента в ленте новостей
* количество полученных и отправленных сообщений в мессенджере
* количество отправителей сообщений пользователю и количество получателей сообщений пользователя

Также все эти метрики рассчитываются в разрезах по полу, возрасту и операционной системе пользователя.
Готовый отчет ежедневно выгружается в ClickHouse.



## airflow_newsfeed_telegram.py
Данный скрипт содержит Airflow-DAG
для формирования отчета по ленте новостей
и для автоматической ежедневной отправки аналитической сводки в Telegram.
Аналитическая сводка включает в себя
значения метрик за предыдущий день
и графики метрик за предыдущую неделю
для следующих ключевых метрик:
* DAU
* Просмотры
* Лайки
* Click-through rate (CTR)



## airflow_application_telegram.py



## airflow_anomaly_telegram.py


